(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.papillon = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _srcState=require("./src/State"),_srcState2=_interopRequireDefault(_srcState),_srcObserver=require("./src/Observer"),_srcObserver2=_interopRequireDefault(_srcObserver);exports.State=_srcState2["default"],exports.Observer=_srcObserver2["default"];

},{"./src/Observer":2,"./src/State":5}],2:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_state=require("./state"),_state2=_interopRequireDefault(_state),_PropertyObserver=require("./PropertyObserver"),_PropertyObserver2=_interopRequireDefault(_PropertyObserver),Observer=function(){function e(t,r,n){var a=this;if(_classCallCheck(this,e),!t||!r||!n)throw new TypeError("Invalid arguments");this.callback=n,this.revert=[],this.state=new _state2["default"]([].concat(r).reduce(function(e,r){var n=new _PropertyObserver2["default"](t,r);return e[r]=t[r],a.revert.push(n.observe(function(t){e[r]=t,a.check()})),e},{}))}return _createClass(e,[{key:"check",value:function(){var e=this;this.requestId||this.checking||(this.requestId=window.requestAnimationFrame(function(){e.checking=!0,e.state.isChanged()&&e.callback(e.state.changelog),e.checking=e.requestId=void 0}))}},{key:"destroy",value:function(){this.requestId&&window.cancelAnimationFrame(this.requestId),this.revert.forEach(function(e){return e()})}}]),e}();exports["default"]=Observer,module.exports=exports["default"];

},{"./PropertyObserver":3,"./state":6}],3:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_PropertyProxy=require("./PropertyProxy"),_PropertyProxy2=_interopRequireDefault(_PropertyProxy),register=new WeakMap,PropertyObserver=function(){function e(t,r){var n=this;_classCallCheck(this,e);var s=e.singleton(t,r,this);return s!==this?s:(this.proxy=new _PropertyProxy2["default"](t,r,function(e){return n.getters.forEach(function(t){return t(e)})},function(e){return n.setters.forEach(function(t){return t(e)})}),this.getters=new Set,void(this.setters=new Set))}return _createClass(e,null,[{key:"singleton",value:function(e,t,r){var n=register.get(e);if(n){if(n[t])return n[t];n[t]=r}else register.set(e,_defineProperty({},t,r));return r}}]),_createClass(e,[{key:"observe",value:function(e,t){var r=this;return this.getters.size||this.proxy.on(),this.getters.add(e),this.setters.add(t||e),function(){r.unobserve(e,t)}}},{key:"unobserve",value:function(e,t){this.getters["delete"](e),this.setters["delete"](t||e),this.getters.size||this.setters.size||this.proxy.off()}}]),e}();exports["default"]=PropertyObserver,module.exports=exports["default"];

},{"./PropertyProxy":4}],4:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),PropertyProxy=function(){function e(t,r,s,i){_classCallCheck(this,e),this.host=t,this.key=r,this.getter=s,this.setter=i||s}return _createClass(e,[{key:"getOwnDescriptor",value:function(){var e=Object.getOwnPropertyDescriptor(this.host,this.key);if(e){if(!e.configurable)throw new TypeError("Cannot create proxy for not configurable property '"+this.key+"'");if(!e.get&&!e.set&&!e.writable)throw new TypeError("Cannot create proxy for readonly property '"+this.key+"'")}return e}},{key:"getProtoDescriptor",value:function(){for(var e=this,t=void 0,r=Object.getPrototypeOf(this.host);r&&!(t=Object.getOwnPropertyDescriptor(r,this.key));)r=Object.getPrototypeOf(r);if(t){if(!t.configurable)throw new TypeError("Cannot create proxy for not configurable property '"+this.key+"'");t.get||t.set||(t.get=function(){delete e.host[e.key];var t=e.host[e.key];return e.on(),t},t.set=function(t){delete e.host[e.key],e.host[e.key]=t,e.on()})}return t}},{key:"on",value:function(){var e=this.getOwnDescriptor();e?this.ownProperty=!0:(this.ownProperty=!1,e=this.getProtoDescriptor()),e||(this.ownProperty=!0,this.notDefined=!0,e={enumerable:!0,writable:!0,configurable:!0}),this.desc=e,this.value=this.host[this.key],Object.defineProperty(this.host,this.key,{configurable:!0,enumerable:this.desc.enumerable,get:this.get.bind(this),set:this.set.bind(this)})}},{key:"off",value:function(){this.ownProperty?this.notDefined?delete this.host[this.key]:(this.desc.get||this.desc.set||(this.desc.value=this.value),Object.defineProperty(this.host,this.key,this.desc)):delete this.host[this.key]}},{key:"get",value:function(){return this.desc.get&&(this.value=this.desc.get.call(this.host)),this.getter(this.value),this.value}},{key:"set",value:function(e){this.notDefined=!1,this.desc.set&&this.desc.set.call(this.host,e),(this.desc.writable||this.desc.get||this.desc.set)&&(this.value=e),this.setter(this.value)}}]),e}();exports["default"]=PropertyProxy,module.exports=exports["default"];

},{}],5:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),map=new WeakMap,timestamp=0,request=!1,State=function(){function e(t){if(_classCallCheck(this,e),!e.isObject(t))throw new TypeError("Invalid arguments");var a=map.get(t);return a?a:(map.set(t,this),this.cache=Object.keys(t).reduce(function(a,n){var r=a[n]=t[n];return e.isObject(r)&&new e(r),a},{}),this.target=t,this.lastCheck=e.now(),void(this.lastChange=0))}return _createClass(e,null,[{key:"now",value:function(){return request||(timestamp+=1,request=window.requestAnimationFrame(function(){return request=void 0})),timestamp}},{key:"isObject",value:function(e){return"object"==typeof e&&null!==e}},{key:"is",value:function(e,t){return 0===e&&0===t?1/e===1/t:e!==e?t!==t:e===t}}]),_createClass(e,[{key:"isChanged",value:function(){var t=this,a=e.now();if(a>this.lastCheck){var n=!1;this.lastCheck=a,this.changelog={},Object.keys(this.cache).forEach(function(e){if(!t.target.hasOwnProperty(e)){var a=t.cache[e];t.changelog[e]={type:"delete",oldValue:a},n=!0}}),this.cache=Object.keys(this.target).reduce(function(a,r){var c=t.target[r];if(t.cache.hasOwnProperty(r)?e.is(c,t.cache[r])||(t.changelog[r]=t.changelog[r]||{type:"update"},t.changelog[r].oldValue=t.cache[r],n=!0):(t.changelog[r]={type:"add"},n=!0),e.isObject(c)){var s=new e(c);s.isChanged()&&(n=!0,t.changelog[r]||(t.changelog[r]={type:"modify"},t.changelog[r].changelog=s.changelog))}return a[r]=t.target[r],a},{}),n?this.lastChange=this.lastCheck:this.changelog=void 0}return this.lastChange===a}}]),e}();exports["default"]=State,module.exports=exports["default"];

},{}],6:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),map=new WeakMap,timestamp=0,request=!1,State=function(){function e(t){if(_classCallCheck(this,e),!e.isObject(t))throw new TypeError("Invalid arguments");var a=map.get(t);return a?a:(map.set(t,this),this.cache=Object.keys(t).reduce(function(a,n){var r=a[n]=t[n];return e.isObject(r)&&new e(r),a},{}),this.target=t,this.lastCheck=e.now(),void(this.lastChange=0))}return _createClass(e,null,[{key:"now",value:function(){return request||(timestamp+=1,request=window.requestAnimationFrame(function(){return request=void 0})),timestamp}},{key:"isObject",value:function(e){return"object"==typeof e&&null!==e}},{key:"is",value:function(e,t){return 0===e&&0===t?1/e===1/t:e!==e?t!==t:e===t}}]),_createClass(e,[{key:"isChanged",value:function(){var t=this,a=e.now();if(a>this.lastCheck){var n=!1;this.lastCheck=a,this.changelog={},Object.keys(this.cache).forEach(function(e){if(!t.target.hasOwnProperty(e)){var a=t.cache[e];t.changelog[e]={type:"delete",oldValue:a},n=!0}}),this.cache=Object.keys(this.target).reduce(function(a,r){var c=t.target[r];if(t.cache.hasOwnProperty(r)?e.is(c,t.cache[r])||(t.changelog[r]=t.changelog[r]||{type:"update"},t.changelog[r].oldValue=t.cache[r],n=!0):(t.changelog[r]={type:"add"},n=!0),e.isObject(c)){var s=new e(c);s.isChanged()&&(n=!0,t.changelog[r]||(t.changelog[r]={type:"modify"},t.changelog[r].changelog=s.changelog))}return a[r]=t.target[r],a},{}),n?this.lastChange=this.lastCheck:this.changelog=void 0}return this.lastChange===a}}]),e}();exports["default"]=State,module.exports=exports["default"];

},{}]},{},[1])(1)
});
//# sourceMappingURL=papillon-umd.js.map
