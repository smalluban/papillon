!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.papillon=t():e.papillon=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=r(i),s=n(2),a=r(s);t.State=o["default"],t.Observer=a["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=new WeakMap,o=0,s=!1,a=function(){function e(t){if(n(this,e),!e.isObject(t))throw new TypeError("Invalid arguments");var r=i.get(t);return r?r:(i.set(t,this),this.cache=Object.keys(t).reduce(function(n,r){var i=n[r]=t[r];return e.isObject(i)&&new e(i),n},{}),this.target=t,this.lastCheck=e.now(),void(this.lastChange=0))}return r(e,null,[{key:"now",value:function(){return s||(o+=1,s=window.requestAnimationFrame(function(){return s=void 0})),o}},{key:"isObject",value:function(e){return"object"==typeof e&&null!==e}},{key:"is",value:function(e,t){return 0===e&&0===t?1/e===1/t:e!==e?t!==t:e===t}}]),r(e,[{key:"isChanged",value:function(){var t=this,n=e.now();if(n>this.lastCheck){var r=!1;this.lastCheck=n,this.changelog={},Object.keys(this.cache).forEach(function(e){if(!t.target.hasOwnProperty(e)){var n=t.cache[e];t.changelog[e]={type:"delete",oldValue:n},r=!0}}),this.cache=Object.keys(this.target).reduce(function(n,i){var o=t.target[i];if(t.cache.hasOwnProperty(i)?e.is(o,t.cache[i])||(t.changelog[i]=t.changelog[i]||{type:"update"},t.changelog[i].oldValue=t.cache[i],r=!0):(t.changelog[i]={type:"add"},r=!0),e.isObject(o)){var s=new e(o);s.isChanged()&&(r=!0,t.changelog[i]||(t.changelog[i]={type:"modify"},t.changelog[i].changelog=s.changelog))}return n[i]=t.target[i],n},{}),r?this.lastChange=this.lastCheck:this.changelog=void 0}return this.lastChange===n}}]),e}();t["default"]=a,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),a=r(s),u=n(3),c=r(u),h=function(){function e(t,n,r){var o=this;if(i(this,e),!t||!n||!r)throw new TypeError("Invalid arguments");this.callback=r,this.revert=[],this.state=new a["default"]([].concat(n).reduce(function(e,n){var r=new c["default"](t,n);return e[n]=t[n],o.revert.push(r.observe(function(t){e[n]=t,o.check()})),e},{}))}return o(e,[{key:"check",value:function(){var e=this;this.requestId||this.checking||(this.requestId=window.requestAnimationFrame(function(){e.checking=!0,e.state.isChanged()&&e.callback(e.state.changelog),e.checking=e.requestId=void 0}))}},{key:"destroy",value:function(){this.requestId&&window.cancelAnimationFrame(this.requestId),this.revert.forEach(function(e){return e()})}}]),e}();t["default"]=h,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(4),u=r(a),c=new WeakMap,h=function(){function e(t,n){var r=this;o(this,e);var i=e.singleton(t,n,this);return i!==this?i:(this.proxy=new u["default"](t,n,function(e){return r.getters.forEach(function(t){return t(e)})},function(e){return r.setters.forEach(function(t){return t(e)})}),this.getters=new Set,void(this.setters=new Set))}return s(e,null,[{key:"singleton",value:function(e,t,n){var r=c.get(e);if(r){if(r[t])return r[t];r[t]=n}else c.set(e,i({},t,n));return n}}]),s(e,[{key:"observe",value:function(e,t){var n=this;return this.getters.size||this.proxy.on(),this.getters.add(e),this.setters.add(t||e),function(){n.unobserve(e,t)}}},{key:"unobserve",value:function(e,t){this.getters["delete"](e),this.setters["delete"](t||e),this.getters.size||this.setters.size||this.proxy.off()}}]),e}();t["default"]=h,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r,i,o){n(this,e),this.host=t,this.key=r,this.getter=i,this.setter=o||i}return r(e,[{key:"getOwnDescriptor",value:function(){var e=Object.getOwnPropertyDescriptor(this.host,this.key);if(e){if(!e.configurable)throw new TypeError("Cannot create proxy for not configurable property '"+this.key+"'");if(!e.get&&!e.set&&!e.writable)throw new TypeError("Cannot create proxy for readonly property '"+this.key+"'")}return e}},{key:"getProtoDescriptor",value:function(){for(var e=this,t=void 0,n=Object.getPrototypeOf(this.host);n&&!(t=Object.getOwnPropertyDescriptor(n,this.key));)n=Object.getPrototypeOf(n);if(t){if(!t.configurable)throw new TypeError("Cannot create proxy for not configurable property '"+this.key+"'");t.get||t.set||(t.get=function(){delete e.host[e.key];var t=e.host[e.key];return e.on(),t},t.set=function(t){delete e.host[e.key],e.host[e.key]=t,e.on()})}return t}},{key:"on",value:function(){var e=this.getOwnDescriptor();e?this.ownProperty=!0:(this.ownProperty=!1,e=this.getProtoDescriptor()),e||(this.ownProperty=!0,this.notDefined=!0,e={enumerable:!0,writable:!0,configurable:!0}),this.desc=e,this.value=this.host[this.key],Object.defineProperty(this.host,this.key,{configurable:!0,enumerable:this.desc.enumerable,get:this.get.bind(this),set:this.set.bind(this)})}},{key:"off",value:function(){this.ownProperty?this.notDefined?delete this.host[this.key]:(this.desc.get||this.desc.set||(this.desc.value=this.value),Object.defineProperty(this.host,this.key,this.desc)):delete this.host[this.key]}},{key:"get",value:function(){return this.desc.get&&(this.value=this.desc.get.call(this.host)),this.getter(this.value),this.value}},{key:"set",value:function(e){this.notDefined=!1,this.desc.set&&this.desc.set.call(this.host,e),(this.desc.writable||this.desc.get||this.desc.set)&&(this.value=e),this.setter(this.value)}}]),e}();t["default"]=i,e.exports=t["default"]}])});
//# sourceMappingURL=papillon-umd.js.map
