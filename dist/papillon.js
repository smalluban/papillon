!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.papillon=t():e.papillon=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e["default"]:e}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.State=r(i);var o=n(3);t.Observer=r(o)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=r(a),u=new WeakMap,c=0,l=!1,f=function(){function e(t){if(i(this,e),!e.isObject(t))throw new TypeError("Invalid arguments");var n=u.get(t);if(n)return n;u.set(t,this);var r=new s["default"];this.cache=Object.keys(t).reduce(function(n,i){var o=n[i]=t[i];return e.isObject(o)&&new e(o),r.set(o,i),n},{}),this.keyMap=r,this.target=t,this.lastCheck=e.now(),this.lastChange=0}return o(e,null,[{key:"now",value:function(){return l||(c+=1,l=window.requestAnimationFrame(function(){return l=void 0})),c}},{key:"isObject",value:function(e){return"object"==typeof e&&null!==e}},{key:"is",value:function(e,t){return 0===e&&0===t?1/e===1/t:e!==e?t!==t:e===t}}]),o(e,[{key:"isChanged",value:function(){var t=this,n=e.now();return n>this.lastCheck&&!function(){var r=!1;t.lastCheck=n,t.changelog={},Object.keys(t.cache).forEach(function(e){if(!t.target.hasOwnProperty(e)){var n=t.cache[e];t.changelog[e]={type:"delete",oldValue:n},r=!0}});var i=new s["default"],o={};t.cache=Object.keys(t.target).reduce(function(n,a){var s=t.target[a];if(t.cache.hasOwnProperty(a)?e.is(s,t.cache[a])||(t.changelog[a]=t.changelog[a]||{type:"set"},t.changelog[a].oldValue=t.cache[a],r=!0):(t.changelog[a]={type:"set"},r=!0),e.isObject(s)){var u=new e(s);u.isChanged()&&(r=!0,t.changelog[a]||(t.changelog[a]={type:"modify"},t.changelog[a].changelog=u.changelog))}if(t.changelog[a]){var c=t.keyMap.shift(s,a);c&&c!==a&&t.target[c]!==s&&(t.changelog[a].oldKey=c,t.changelog[c]?t.changelog[c].newKey=a:o[c]=a),o[a]&&(t.changelog[a].newKey=o[a])}return n[a]=s,i.set(s,a),n},{}),t.keyMap=i,r?t.lastChange=t.lastCheck:t.changelog=void 0}(),this.lastChange===n}}]),e}();t["default"]=f,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e),this.map=new Map}return r(e,[{key:"set",value:function t(e,n){var t=this.map.get(e);return t||(t=new Set,this.map.set(e,t)),n&&t.add(n),t}},{key:"shift",value:function(e,t){var n=this.map.get(e);if(n&&n.size){if(n.has(t))return n["delete"](t),t;var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;return n["delete"](u),u}}catch(c){i=!0,o=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}return!1}}]),e}();t["default"]=i,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=r(a),u=n(4),c=r(u),l=function(){function e(t,n,r){var o=this;if(i(this,e),!t||!n||!r)throw new TypeError("Invalid arguments");this.callback=r,this.revert=[],this.state=new s["default"]([].concat(n).reduce(function(e,n){var r=new c["default"](t,n);return e[n]=t[n],o.revert.push(r.observe(function(t){s["default"].is(e[n],t)?s["default"].isObject(t)&&o.check():(e[n]=t,o.check())})),e},{}))}return o(e,null,[{key:"requestAnimationFrame",value:function(e){var t=this;return this._request?this._callbacks.add(e):(this._callbacks=(new Set).add(e),this._request=window.requestAnimationFrame(function(){t._callbacks.forEach(function(e){return e()}),t._request=t._callbacks=void 0})),e}},{key:"cancelAnimationFrame",value:function(e){this._callbacks&&this._callbacks["delete"](e)}}]),o(e,[{key:"check",value:function(){var t=this;this.checkFn||(this.checkFn=e.requestAnimationFrame(function(){t.state.isChanged()&&t.callback(t.state.changelog),t.checkFn=void 0}))}},{key:"destroy",value:function(){this.checkFn&&e.cancelAnimationFrame(this.checkFn),this.revert.forEach(function(e){return e()})}}]),e}();t["default"]=l,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(5),u=r(s),c=new WeakMap,l=function(){function e(t,n){var r=this;o(this,e);var i=e.singleton(t,n,this);return i!==this?i:(this.proxy=new u["default"](t,n,function(e){return r.getters.forEach(function(t){return t(e)})},function(e){return r.setters.forEach(function(t){return t(e)})}),this.getters=new Set,void(this.setters=new Set))}return a(e,null,[{key:"singleton",value:function(e,t,n){var r=c.get(e);if(r){if(r[t])return r[t];r[t]=n}else c.set(e,i({},t,n));return n}}]),a(e,[{key:"observe",value:function(e,t){var n=this;return this.getters.size||this.proxy.on(),this.getters.add(e),this.setters.add(t||e),function(){n.unobserve(e,t)}}},{key:"unobserve",value:function(e,t){this.getters["delete"](e),this.setters["delete"](t||e),this.getters.size||this.setters.size||this.proxy.off()}}]),e}();t["default"]=l,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r,i,o){n(this,e),this.host=t,this.key=r,this.getter=i,this.setter=o||i}return r(e,[{key:"getOwnDescriptor",value:function(){var e=Object.getOwnPropertyDescriptor(this.host,this.key);if(e){if(!e.configurable)throw new TypeError("Cannot create proxy for not configurable property '"+this.key+"'");if(!e.get&&!e.set&&!e.writable)throw new TypeError("Cannot create proxy for readonly property '"+this.key+"'")}return e}},{key:"getProtoDescriptor",value:function(){for(var e=this,t=void 0,n=Object.getPrototypeOf(this.host);n&&!(t=Object.getOwnPropertyDescriptor(n,this.key));)n=Object.getPrototypeOf(n);return t&&(t.get||t.set||(t.get=function(){delete e.host[e.key];var t=e.host[e.key];return e.on(),t},t.set=function(t){delete e.host[e.key],e.host[e.key]=t,e.on()})),t}},{key:"on",value:function(){var e=this.getOwnDescriptor();e?this.ownProperty=!0:(this.ownProperty=!1,e=this.getProtoDescriptor()),e||(this.ownProperty=!0,this.notDefined=!0,e={enumerable:!0,writable:!0,configurable:!0}),this.desc=e,this.value=this.host[this.key],Object.defineProperty(this.host,this.key,{configurable:!0,enumerable:this.desc.enumerable,get:this.get.bind(this),set:this.set.bind(this)})}},{key:"off",value:function(){this.ownProperty?this.notDefined?delete this.host[this.key]:(this.desc.get||this.desc.set||(this.desc.value=this.value),Object.defineProperty(this.host,this.key,this.desc)):delete this.host[this.key]}},{key:"get",value:function(){return this.desc.get&&(this.value=this.desc.get.call(this.host)),this.getter(this.value),this.value}},{key:"set",value:function(e){this.notDefined=!1,this.desc.set&&this.desc.set.call(this.host,e),(this.desc.writable||this.desc.get||this.desc.set)&&(this.value=e),this.setter(this.value)}}]),e}();t["default"]=i,e.exports=t["default"]}])});
//# sourceMappingURL=papillon.js.map
