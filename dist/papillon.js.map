{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///papillon.js","webpack:///webpack/bootstrap 120f82bf6a88d7dcd4d6","webpack:///./papillon.js","webpack:///./src/State.js","webpack:///./src/KeyMap.js","webpack:///./src/Observer.js","webpack:///./src/PropertyObserver.js","webpack:///./src/PropertyProxy.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequire","obj","__esModule","Object","defineProperty","value","_srcState","State","_srcObserver","Observer","_srcPropertyObserver","PropertyObserver","_interopRequireDefault","default","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_KeyMap","_KeyMap2","map","WeakMap","timestamp","request","isObject","state","get","set","keyMap","cache","keys","reduce","lastCheck","now","lastChange","window","requestAnimationFrame","undefined","v1","v2","_this","changed","changelog","forEach","hasOwnProperty","type","oldValue","cacheNewKeys","is","nestedState","isChanged","oldKey","shift","newKey","KeyMap","Map","list","Set","add","size","has","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","result","err","_State","_State2","_PropertyObserver","_PropertyObserver2","host","callback","_this2","revert","concat","observer","push","observe","check","cb","_request","_callbacks","_this3","checkFn","cancelAnimationFrame","_defineProperty","_PropertyProxy","_PropertyProxy2","register","singleton","proxy","getters","newValue","setters","on","unobserve","off","PropertyProxy","getter","setter","desc","getOwnPropertyDescriptor","getPrototypeOf","newVal","getOwnDescriptor","ownProperty","getProtoDescriptor","notDefined","bind"],"mappings":"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","file":"papillon.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"papillon\"] = factory();\n\telse\n\t\troot[\"papillon\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"papillon\"] = factory();\n\telse\n\t\troot[\"papillon\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequire(obj) { return obj && obj.__esModule ? obj['default'] : obj; }\n\t\n\tvar _srcState = __webpack_require__(1);\n\t\n\texports.State = _interopRequire(_srcState);\n\t\n\tvar _srcObserver = __webpack_require__(3);\n\t\n\texports.Observer = _interopRequire(_srcObserver);\n\t\n\tvar _srcPropertyObserver = __webpack_require__(4);\n\t\n\texports.PropertyObserver = _interopRequire(_srcPropertyObserver);\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _KeyMap = __webpack_require__(2);\n\t\n\tvar _KeyMap2 = _interopRequireDefault(_KeyMap);\n\t\n\tvar map = new WeakMap();\n\tvar timestamp = 0;\n\tvar request = false;\n\t\n\tvar State = (function () {\n\t  _createClass(State, null, [{\n\t    key: 'now',\n\t    value: function now() {\n\t      if (!request) {\n\t        timestamp = timestamp + 1;\n\t        request = window.requestAnimationFrame(function () {\n\t          return request = undefined;\n\t        });\n\t      }\n\t      return timestamp;\n\t    }\n\t  }, {\n\t    key: 'isObject',\n\t    value: function isObject(target) {\n\t      return typeof target === 'object' && target !== null;\n\t    }\n\t  }, {\n\t    key: 'is',\n\t    value: function is(v1, v2) {\n\t      if (v1 === 0 && v2 === 0) {\n\t        return 1 / v1 === 1 / v2;\n\t      }\n\t      if (v1 !== v1) {\n\t        return v2 !== v2;\n\t      }\n\t      return v1 === v2;\n\t    }\n\t  }]);\n\t\n\t  function State(target) {\n\t    _classCallCheck(this, State);\n\t\n\t    if (!State.isObject(target)) {\n\t      throw new TypeError('Invalid arguments');\n\t    }\n\t    var state = map.get(target);\n\t    if (state) {\n\t      return state;\n\t    }\n\t    map.set(target, this);\n\t\n\t    var keyMap = new _KeyMap2['default']();\n\t    this.cache = Object.keys(target).reduce(function (cache, key) {\n\t      var value = cache[key] = target[key];\n\t      if (State.isObject(value)) {\n\t        new State(value);\n\t      }\n\t      keyMap.set(value, key);\n\t      return cache;\n\t    }, {});\n\t\n\t    this.keyMap = keyMap;\n\t    this.target = target;\n\t    this.lastCheck = State.now();\n\t    this.lastChange = 0;\n\t  }\n\t\n\t  _createClass(State, [{\n\t    key: 'isChanged',\n\t    value: function isChanged() {\n\t      var _this = this;\n\t\n\t      var timestamp = State.now();\n\t\n\t      if (timestamp > this.lastCheck) {\n\t        (function () {\n\t          var changed = false;\n\t\n\t          _this.lastCheck = timestamp;\n\t          _this.changelog = {};\n\t\n\t          Object.keys(_this.cache).forEach(function (key) {\n\t            if (!_this.target.hasOwnProperty(key)) {\n\t              var value = _this.cache[key];\n\t              _this.changelog[key] = { type: 'delete', oldValue: value };\n\t              changed = true;\n\t            }\n\t          });\n\t\n\t          var keyMap = new _KeyMap2['default']();\n\t          var cacheNewKeys = {};\n\t          _this.cache = Object.keys(_this.target).reduce(function (cache, key) {\n\t            var value = _this.target[key];\n\t\n\t            if (!_this.cache.hasOwnProperty(key)) {\n\t              _this.changelog[key] = { type: 'set' };\n\t              changed = true;\n\t            } else if (!State.is(value, _this.cache[key])) {\n\t              _this.changelog[key] = _this.changelog[key] || { type: 'set' };\n\t              _this.changelog[key].oldValue = _this.cache[key];\n\t              changed = true;\n\t            }\n\t\n\t            if (State.isObject(value)) {\n\t              var nestedState = new State(value);\n\t              if (nestedState.isChanged()) {\n\t                changed = true;\n\t                if (!_this.changelog[key]) {\n\t                  _this.changelog[key] = { type: 'modify' };\n\t                  _this.changelog[key].changelog = nestedState.changelog;\n\t                }\n\t              }\n\t            }\n\t\n\t            if (_this.changelog[key]) {\n\t              var oldKey = _this.keyMap.shift(value, key);\n\t              if (oldKey && oldKey !== key && _this.target[oldKey] !== value) {\n\t                _this.changelog[key].oldKey = oldKey;\n\t                if (_this.changelog[oldKey]) {\n\t                  _this.changelog[oldKey].newKey = key;\n\t                } else {\n\t                  cacheNewKeys[oldKey] = key;\n\t                }\n\t              }\n\t\n\t              if (cacheNewKeys[key]) {\n\t                _this.changelog[key].newKey = cacheNewKeys[key];\n\t              }\n\t            }\n\t\n\t            cache[key] = value;\n\t            keyMap.set(value, key);\n\t            return cache;\n\t          }, {});\n\t\n\t          _this.keyMap = keyMap;\n\t\n\t          if (changed) {\n\t            _this.lastChange = _this.lastCheck;\n\t          } else {\n\t            _this.changelog = undefined;\n\t          }\n\t        })();\n\t      }\n\t\n\t      return this.lastChange === timestamp;\n\t    }\n\t  }]);\n\t\n\t  return State;\n\t})();\n\t\n\texports['default'] = State;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar KeyMap = (function () {\n\t  function KeyMap() {\n\t    _classCallCheck(this, KeyMap);\n\t\n\t    this.map = new Map();\n\t  }\n\t\n\t  _createClass(KeyMap, [{\n\t    key: \"set\",\n\t    value: function set(key, value) {\n\t      var list = this.map.get(key);\n\t      if (!list) {\n\t        list = new Set();\n\t        this.map.set(key, list);\n\t      }\n\t\n\t      if (value) {\n\t        list.add(value);\n\t      }\n\t\n\t      return list;\n\t    }\n\t  }, {\n\t    key: \"shift\",\n\t    value: function shift(key, value) {\n\t      var set = this.map.get(key);\n\t      if (set && set.size) {\n\t        if (set.has(value)) {\n\t          set[\"delete\"](value);\n\t          return value;\n\t        } else {\n\t          var _iteratorNormalCompletion = true;\n\t          var _didIteratorError = false;\n\t          var _iteratorError = undefined;\n\t\n\t          try {\n\t            for (var _iterator = set[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t              var result = _step.value;\n\t\n\t              set[\"delete\"](result);\n\t              return result;\n\t            }\n\t          } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t          } finally {\n\t            try {\n\t              if (!_iteratorNormalCompletion && _iterator[\"return\"]) {\n\t                _iterator[\"return\"]();\n\t              }\n\t            } finally {\n\t              if (_didIteratorError) {\n\t                throw _iteratorError;\n\t              }\n\t            }\n\t          }\n\t        }\n\t      }\n\t      return false;\n\t    }\n\t  }]);\n\t\n\t  return KeyMap;\n\t})();\n\t\n\texports[\"default\"] = KeyMap;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _State = __webpack_require__(1);\n\t\n\tvar _State2 = _interopRequireDefault(_State);\n\t\n\tvar _PropertyObserver = __webpack_require__(4);\n\t\n\tvar _PropertyObserver2 = _interopRequireDefault(_PropertyObserver);\n\t\n\tvar Observer = (function () {\n\t  _createClass(Observer, null, [{\n\t    key: 'requestAnimationFrame',\n\t    value: function requestAnimationFrame(cb) {\n\t      var _this = this;\n\t\n\t      if (!this._request) {\n\t        this._callbacks = new Set().add(cb);\n\t        this._request = window.requestAnimationFrame(function () {\n\t          _this._callbacks.forEach(function (cb) {\n\t            return cb();\n\t          });\n\t          _this._request = _this._callbacks = undefined;\n\t        });\n\t      } else {\n\t        this._callbacks.add(cb);\n\t      }\n\t\n\t      return cb;\n\t    }\n\t  }, {\n\t    key: 'cancelAnimationFrame',\n\t    value: function cancelAnimationFrame(cb) {\n\t      if (this._callbacks) {\n\t        this._callbacks['delete'](cb);\n\t      }\n\t    }\n\t  }]);\n\t\n\t  function Observer(host, keys, callback) {\n\t    var _this2 = this;\n\t\n\t    _classCallCheck(this, Observer);\n\t\n\t    if (!host || !keys || !callback) {\n\t      throw new TypeError('Invalid arguments');\n\t    }\n\t\n\t    this.callback = callback;\n\t    this.revert = [];\n\t\n\t    this.state = new _State2['default']([].concat(keys).reduce(function (list, key) {\n\t      var observer = new _PropertyObserver2['default'](host, key);\n\t      list[key] = host[key];\n\t\n\t      _this2.revert.push(observer.observe(function (value) {\n\t        if (!_State2['default'].is(list[key], value)) {\n\t          list[key] = value;\n\t          _this2.check();\n\t        } else if (_State2['default'].isObject(value)) {\n\t          _this2.check();\n\t        }\n\t      }));\n\t\n\t      return list;\n\t    }, {}));\n\t  }\n\t\n\t  _createClass(Observer, [{\n\t    key: 'check',\n\t    value: function check() {\n\t      var _this3 = this;\n\t\n\t      if (!this.checkFn) {\n\t        this.checkFn = Observer.requestAnimationFrame(function () {\n\t          if (_this3.state.isChanged()) {\n\t            _this3.callback(_this3.state.changelog);\n\t          }\n\t\n\t          _this3.checkFn = undefined;\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      if (this.checkFn) {\n\t        Observer.cancelAnimationFrame(this.checkFn);\n\t      }\n\t\n\t      this.revert.forEach(function (cb) {\n\t        return cb();\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return Observer;\n\t})();\n\t\n\texports['default'] = Observer;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _PropertyProxy = __webpack_require__(5);\n\t\n\tvar _PropertyProxy2 = _interopRequireDefault(_PropertyProxy);\n\t\n\tvar register = new WeakMap();\n\t\n\tvar PropertyObserver = (function () {\n\t  _createClass(PropertyObserver, null, [{\n\t    key: 'singleton',\n\t    value: function singleton(host, key, target) {\n\t      var instance = register.get(host);\n\t      if (instance) {\n\t        if (instance[key]) {\n\t          return instance[key];\n\t        } else {\n\t          instance[key] = target;\n\t        }\n\t      } else {\n\t        register.set(host, _defineProperty({}, key, target));\n\t      }\n\t\n\t      return target;\n\t    }\n\t  }]);\n\t\n\t  function PropertyObserver(host, key) {\n\t    var _this = this;\n\t\n\t    _classCallCheck(this, PropertyObserver);\n\t\n\t    var singleton = PropertyObserver.singleton(host, key, this);\n\t    if (singleton !== this) {\n\t      return singleton;\n\t    }\n\t\n\t    this.proxy = new _PropertyProxy2['default'](host, key, function (value) {\n\t      return _this.getters.forEach(function (cb) {\n\t        return cb(value);\n\t      });\n\t    }, function (newValue) {\n\t      return _this.setters.forEach(function (cb) {\n\t        return cb(newValue);\n\t      });\n\t    });\n\t\n\t    this.getters = new Set();\n\t    this.setters = new Set();\n\t  }\n\t\n\t  _createClass(PropertyObserver, [{\n\t    key: 'observe',\n\t    value: function observe(get, set) {\n\t      var _this2 = this;\n\t\n\t      if (!this.getters.size) {\n\t        this.proxy.on();\n\t      }\n\t\n\t      this.getters.add(get);\n\t      this.setters.add(set || get);\n\t\n\t      return function () {\n\t        _this2.unobserve(get, set);\n\t      };\n\t    }\n\t  }, {\n\t    key: 'unobserve',\n\t    value: function unobserve(get, set) {\n\t      this.getters['delete'](get);\n\t      this.setters['delete'](set || get);\n\t\n\t      if (!this.getters.size && !this.setters.size) {\n\t        this.proxy.off();\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return PropertyObserver;\n\t})();\n\t\n\texports['default'] = PropertyObserver;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar PropertyProxy = (function () {\n\t  function PropertyProxy(host, key, get, set) {\n\t    _classCallCheck(this, PropertyProxy);\n\t\n\t    this.host = host;\n\t    this.key = key;\n\t    this.getter = get;\n\t    this.setter = set || get;\n\t  }\n\t\n\t  _createClass(PropertyProxy, [{\n\t    key: \"getOwnDescriptor\",\n\t    value: function getOwnDescriptor() {\n\t      var desc = Object.getOwnPropertyDescriptor(this.host, this.key);\n\t\n\t      if (desc) {\n\t        if (!desc.configurable) {\n\t          throw new TypeError(\"Cannot create proxy for not configurable property '\" + this.key + \"'\");\n\t        }\n\t        if (!desc.get && !desc.set && !desc.writable) {\n\t          throw new TypeError(\"Cannot create proxy for readonly property '\" + this.key + \"'\");\n\t        }\n\t      }\n\t\n\t      return desc;\n\t    }\n\t  }, {\n\t    key: \"getProtoDescriptor\",\n\t    value: function getProtoDescriptor() {\n\t      var _this = this;\n\t\n\t      var desc = undefined,\n\t          host = Object.getPrototypeOf(this.host);\n\t\n\t      while (host) {\n\t        desc = Object.getOwnPropertyDescriptor(host, this.key);\n\t        if (desc) {\n\t          break;\n\t        } else {\n\t          host = Object.getPrototypeOf(host);\n\t        }\n\t      }\n\t\n\t      if (desc) {\n\t        if (!desc.get && !desc.set) {\n\t          desc.get = function () {\n\t            delete _this.host[_this.key];\n\t            var value = _this.host[_this.key];\n\t            _this.on();\n\t            return value;\n\t          };\n\t          desc.set = function (newVal) {\n\t            delete _this.host[_this.key];\n\t            _this.host[_this.key] = newVal;\n\t            _this.on();\n\t          };\n\t        }\n\t      }\n\t\n\t      return desc;\n\t    }\n\t  }, {\n\t    key: \"on\",\n\t    value: function on() {\n\t      var desc = this.getOwnDescriptor();\n\t\n\t      if (desc) {\n\t        this.ownProperty = true;\n\t      } else {\n\t        this.ownProperty = false;\n\t        desc = this.getProtoDescriptor();\n\t      }\n\t\n\t      if (!desc) {\n\t        this.ownProperty = true;\n\t        this.notDefined = true;\n\t        desc = {\n\t          enumerable: true,\n\t          writable: true,\n\t          configurable: true\n\t        };\n\t      }\n\t\n\t      this.desc = desc;\n\t      this.value = this.host[this.key];\n\t\n\t      Object.defineProperty(this.host, this.key, {\n\t        configurable: true,\n\t        enumerable: this.desc.enumerable,\n\t        get: this.get.bind(this),\n\t        set: this.set.bind(this)\n\t      });\n\t    }\n\t  }, {\n\t    key: \"off\",\n\t    value: function off() {\n\t      if (this.ownProperty) {\n\t        if (this.notDefined) {\n\t          delete this.host[this.key];\n\t        } else {\n\t          if (!this.desc.get && !this.desc.set) {\n\t            this.desc.value = this.value;\n\t          }\n\t          Object.defineProperty(this.host, this.key, this.desc);\n\t        }\n\t      } else {\n\t        delete this.host[this.key];\n\t      }\n\t    }\n\t  }, {\n\t    key: \"get\",\n\t    value: function get() {\n\t      if (this.desc.get) {\n\t        this.value = this.desc.get.call(this.host);\n\t      }\n\t      this.getter(this.value);\n\t      return this.value;\n\t    }\n\t  }, {\n\t    key: \"set\",\n\t    value: function set(newValue) {\n\t      this.notDefined = false;\n\t\n\t      if (this.desc.set) {\n\t        this.desc.set.call(this.host, newValue);\n\t      }\n\t\n\t      if (this.desc.writable || this.desc.get || this.desc.set) {\n\t        this.value = newValue;\n\t      }\n\t\n\t      this.setter(this.value);\n\t    }\n\t  }]);\n\t\n\t  return PropertyProxy;\n\t})();\n\t\n\texports[\"default\"] = PropertyProxy;\n\tmodule.exports = exports[\"default\"];\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** papillon.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 120f82bf6a88d7dcd4d6\n **/","export { default as State } from './src/State';\nexport { default as Observer } from './src/Observer';\nexport { default as PropertyObserver } from './src/PropertyObserver';\n\n\n\n/** WEBPACK FOOTER **\n ** ./papillon.js\n **/","import KeyMap from './KeyMap';\n\nconst map = new WeakMap();\nlet timestamp = 0;\nlet request = false;\n\nclass State {\n\n  static now() {\n    if (!request) {\n      timestamp = timestamp + 1;\n      request = window.requestAnimationFrame(\n        ()=> request = undefined\n      );\n    }\n    return timestamp;\n  }\n\n  static isObject(target) {\n    return typeof(target) === 'object' && target !== null;\n  }\n\n  static is(v1, v2) {\n    if (v1 === 0 && v2 === 0) {\n      return 1 / v1 === 1 / v2;\n    }\n    if (v1 !== v1) {\n      return v2 !== v2;\n    }\n    return v1 === v2;\n  }\n\n  constructor(target) {\n    if (!State.isObject(target)) {\n      throw new TypeError('Invalid arguments');\n    }\n    const state = map.get(target);\n    if (state) { return state; }\n    map.set(target, this);\n\n    const keyMap = new KeyMap();\n    this.cache = Object.keys(target).reduce((cache, key)=> {\n      let value = cache[key] = target[key];\n      if (State.isObject(value)) {\n        new State(value);\n      }\n      keyMap.set(value, key);\n      return cache;\n    }, {});\n\n    this.keyMap = keyMap;\n    this.target = target;\n    this.lastCheck = State.now();\n    this.lastChange = 0;\n  }\n\n  isChanged() {\n    let timestamp = State.now();\n\n    if (timestamp > this.lastCheck) {\n      let changed = false;\n\n      this.lastCheck = timestamp;\n      this.changelog = {};\n\n      Object.keys(this.cache).forEach((key)=> {\n        if (!this.target.hasOwnProperty(key)) {\n          let value = this.cache[key];\n          this.changelog[key] = { type: 'delete', oldValue: value };\n          changed = true;\n        }\n      });\n\n      const keyMap = new KeyMap();\n      const cacheNewKeys = {};\n      this.cache = Object.keys(this.target).reduce((cache, key)=> {\n        const value = this.target[key];\n\n        if (!this.cache.hasOwnProperty(key)) {\n          this.changelog[key] = { type:'set' };\n          changed = true;\n        } else if (!State.is(value, this.cache[key])) {\n          this.changelog[key] = this.changelog[key] || { type: 'set'};\n          this.changelog[key].oldValue = this.cache[key];\n          changed = true;\n        }\n\n        if (State.isObject(value)) {\n          let nestedState = new State(value);\n          if (nestedState.isChanged()) {\n            changed = true;\n            if (!this.changelog[key]) {\n              this.changelog[key] = { type: 'modify' };\n              this.changelog[key].changelog = nestedState.changelog;\n            }\n          }\n        }\n\n        if (this.changelog[key]) {\n          const oldKey = this.keyMap.shift(value, key);\n          if (oldKey && oldKey !== key && this.target[oldKey] !== value) {\n            this.changelog[key].oldKey = oldKey;\n            if (this.changelog[oldKey]) {\n              this.changelog[oldKey].newKey = key;\n            } else {\n              cacheNewKeys[oldKey] = key;\n            }\n          }\n\n          if (cacheNewKeys[key]) {\n            this.changelog[key].newKey = cacheNewKeys[key];\n          }\n        }\n\n        cache[key] = value;\n        keyMap.set(value, key);\n        return cache;\n      }, {});\n\n      this.keyMap = keyMap;\n\n      if (changed) {\n        this.lastChange = this.lastCheck;\n      } else {\n        this.changelog = undefined;\n      }\n    }\n\n    return this.lastChange === timestamp;\n  }\n}\n\nexport default State;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/State.js\n **/","class KeyMap {\n    constructor() {\n      this.map = new Map();\n    }\n\n    set(key, value) {\n      let list = this.map.get(key);\n      if (!list) {\n        list = new Set();\n        this.map.set(key, list);\n      }\n\n      if (value) {\n        list.add(value);\n      }\n\n      return list;\n    }\n\n    shift(key, value) {\n      let set = this.map.get(key);\n      if (set && set.size) {\n        if (set.has(value)) {\n          set.delete(value);\n          return value;\n        } else {\n          for(let result of set) {\n            set.delete(result);\n            return result;\n          }\n        }\n      }\n      return false;\n    }\n}\n\nexport default KeyMap;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/KeyMap.js\n **/","import State from './State';\nimport PropertyObserver from './PropertyObserver';\n\nclass Observer {\n  static requestAnimationFrame(cb) {\n    if (!this._request) {\n      this._callbacks = new Set().add(cb);\n      this._request = window.requestAnimationFrame(()=> {\n        this._callbacks.forEach(cb => cb());\n        this._request = this._callbacks = undefined;\n      });\n    } else {\n      this._callbacks.add(cb);\n    }\n\n    return cb;\n  }\n\n  static cancelAnimationFrame(cb) {\n    if (this._callbacks) {\n      this._callbacks.delete(cb);\n    }\n  }\n\n  constructor(host, keys, callback) {\n    if (!host || !keys || !callback) {\n      throw new TypeError('Invalid arguments');\n    }\n\n    this.callback = callback;\n    this.revert = [];\n\n    this.state = new State(\n      [].concat(keys).reduce( (list, key) => {\n        let observer = new PropertyObserver(host, key);\n        list[key] = host[key];\n\n        this.revert.push(observer.observe((value)=> {\n          if (!State.is(list[key], value)) {\n            list[key] = value;\n            this.check();\n          } else if (State.isObject(value)) {\n            this.check();\n          }\n        }));\n\n        return list;\n      }, {})\n    );\n  }\n\n  check() {\n    if (!this.checkFn) {\n      this.checkFn = Observer.requestAnimationFrame(()=> {\n        if (this.state.isChanged()) {\n          this.callback(this.state.changelog);\n        }\n\n        this.checkFn = undefined;\n      });\n    }\n  }\n\n  destroy() {\n    if (this.checkFn) {\n      Observer.cancelAnimationFrame(this.checkFn);\n    }\n\n    this.revert.forEach(cb => cb());\n  }\n}\n\nexport default Observer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Observer.js\n **/","import PropertyProxy from './PropertyProxy';\n\nlet register = new WeakMap();\n\nclass PropertyObserver {\n  static singleton(host, key, target) {\n    let instance = register.get(host);\n    if (instance) {\n      if (instance[key]) {\n        return instance[key];\n      } else {\n        instance[key] = target;\n      }\n    } else {\n      register.set(host, { [key]: target });\n    }\n\n    return target;\n  }\n\n  constructor(host, key) {\n    let singleton = PropertyObserver.singleton(host, key, this);\n    if (singleton !== this) {\n      return singleton;\n    }\n\n    this.proxy = new PropertyProxy(host, key,\n      (value)=> this.getters.forEach(cb => cb(value)),\n      (newValue)=> this.setters.forEach(cb => cb(newValue))\n    );\n\n    this.getters = new Set();\n    this.setters = new Set();\n  }\n\n  observe(get, set) {\n    if (!this.getters.size) {\n      this.proxy.on();\n    }\n\n    this.getters.add(get);\n    this.setters.add(set || get);\n\n    return ()=> {\n      this.unobserve(get, set);\n    };\n  }\n\n  unobserve(get, set) {\n    this.getters.delete(get);\n    this.setters.delete(set || get);\n\n    if (!this.getters.size && !this.setters.size) {\n      this.proxy.off();\n    }\n  }\n}\n\nexport default PropertyObserver;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/PropertyObserver.js\n **/","class PropertyProxy {\n  constructor(host, key, get, set) {\n    this.host = host;\n    this.key = key;\n    this.getter = get;\n    this.setter = set || get;\n  }\n\n  getOwnDescriptor() {\n    let desc = Object.getOwnPropertyDescriptor(this.host, this.key);\n\n    if (desc) {\n      if (!desc.configurable) {\n        throw new TypeError(\n          `Cannot create proxy for not configurable property '${this.key}'`);\n      }\n      if (!desc.get && !desc.set && !desc.writable) {\n        throw new TypeError(\n          `Cannot create proxy for readonly property '${this.key}'`);\n      }\n    }\n\n    return desc;\n  }\n\n  getProtoDescriptor() {\n    let desc, host = Object.getPrototypeOf(this.host);\n\n    while(host) {\n      desc = Object.getOwnPropertyDescriptor(host, this.key);\n      if (desc) {\n        break;\n      } else {\n        host = Object.getPrototypeOf(host);\n      }\n    }\n\n    if (desc) {\n      if (!desc.get && !desc.set) {\n        desc.get = ()=> {\n          delete this.host[this.key];\n          let value = this.host[this.key];\n          this.on();\n          return value;\n        };\n        desc.set = (newVal)=> {\n          delete this.host[this.key];\n          this.host[this.key] = newVal;\n          this.on();\n        };\n      }\n    }\n\n    return desc;\n  }\n\n  on() {\n    let desc = this.getOwnDescriptor();\n\n    if (desc) {\n      this.ownProperty = true;\n    } else {\n      this.ownProperty = false;\n      desc = this.getProtoDescriptor();\n    }\n\n    if (!desc) {\n      this.ownProperty = true;\n      this.notDefined = true;\n      desc = {\n        enumerable: true,\n        writable: true,\n        configurable: true\n      };\n    }\n\n    this.desc = desc;\n    this.value = this.host[this.key];\n\n    Object.defineProperty(this.host, this.key, {\n      configurable: true,\n      enumerable: this.desc.enumerable,\n      get: this.get.bind(this),\n      set: this.set.bind(this)\n    });\n  }\n\n  off() {\n    if (this.ownProperty) {\n      if (this.notDefined) {\n        delete this.host[this.key];\n      } else {\n        if (!this.desc.get && !this.desc.set) {\n          this.desc.value = this.value;\n        }\n        Object.defineProperty(this.host, this.key, this.desc);\n      }\n    } else {\n      delete this.host[this.key];\n    }\n  }\n\n  get() {\n    if (this.desc.get) {\n      this.value = this.desc.get.call(this.host);\n    }\n    this.getter(this.value);\n    return this.value;\n  }\n\n  set(newValue) {\n    this.notDefined = false;\n\n    if (this.desc.set) {\n      this.desc.set.call(this.host, newValue);\n    }\n\n    if (this.desc.writable || this.desc.get || this.desc.set) {\n      this.value = newValue;\n    }\n\n    this.setter(this.value);\n  }\n}\n\nexport default PropertyProxy;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/PropertyProxy.js\n **/"],"sourceRoot":""}