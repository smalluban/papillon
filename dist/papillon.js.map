{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///papillon.js","webpack:///webpack/bootstrap a1928f9122415496bf4e","webpack:///./papillon.js","webpack:///./src/State.js","webpack:///./src/KeyMap.js","webpack:///./src/Observer.js","webpack:///./src/PropertyObserver.js","webpack:///./src/PropertyProxy.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequire","obj","__esModule","Object","defineProperty","value","_srcState","State","_srcObserver","Observer","_interopRequireDefault","default","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_KeyMap","_KeyMap2","map","WeakMap","timestamp","request","isObject","state","get","set","keyMap","cache","keys","reduce","lastCheck","now","lastChange","window","requestAnimationFrame","undefined","v1","v2","_this","changed","changelog","forEach","hasOwnProperty","type","oldValue","cacheNewKeys","is","nestedState","isChanged","oldKey","shift","newKey","KeyMap","Map","list","Set","add","size","has","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","result","err","_State","_State2","_PropertyObserver","_PropertyObserver2","host","callback","_this2","revert","concat","observer","push","observe","check","cb","_request","_callbacks","_this3","checkFn","cancelAnimationFrame","_defineProperty","_PropertyProxy","_PropertyProxy2","register","PropertyObserver","singleton","proxy","getters","newValue","setters","on","unobserve","off","PropertyProxy","getter","setter","desc","getOwnPropertyDescriptor","getPrototypeOf","newVal","getOwnDescriptor","ownProperty","getProtoDescriptor","notDefined","bind"],"mappings":"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","file":"papillon.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"papillon\"] = factory();\n\telse\n\t\troot[\"papillon\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"papillon\"] = factory();\n\telse\n\t\troot[\"papillon\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tfunction _interopRequire(obj) { return obj && obj.__esModule ? obj['default'] : obj; }\n\t\n\tvar _srcState = __webpack_require__(1);\n\t\n\texports.State = _interopRequire(_srcState);\n\t\n\tvar _srcObserver = __webpack_require__(3);\n\t\n\texports.Observer = _interopRequire(_srcObserver);\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _KeyMap = __webpack_require__(2);\n\t\n\tvar _KeyMap2 = _interopRequireDefault(_KeyMap);\n\t\n\tvar map = new WeakMap();\n\tvar timestamp = 0;\n\tvar request = false;\n\t\n\tvar State = (function () {\n\t  _createClass(State, null, [{\n\t    key: 'now',\n\t    value: function now() {\n\t      if (!request) {\n\t        timestamp = timestamp + 1;\n\t        request = window.requestAnimationFrame(function () {\n\t          return request = undefined;\n\t        });\n\t      }\n\t      return timestamp;\n\t    }\n\t  }, {\n\t    key: 'isObject',\n\t    value: function isObject(target) {\n\t      return typeof target === 'object' && target !== null;\n\t    }\n\t  }, {\n\t    key: 'is',\n\t    value: function is(v1, v2) {\n\t      if (v1 === 0 && v2 === 0) {\n\t        return 1 / v1 === 1 / v2;\n\t      }\n\t      if (v1 !== v1) {\n\t        return v2 !== v2;\n\t      }\n\t      return v1 === v2;\n\t    }\n\t  }]);\n\t\n\t  function State(target) {\n\t    _classCallCheck(this, State);\n\t\n\t    if (!State.isObject(target)) {\n\t      throw new TypeError('Invalid arguments');\n\t    }\n\t    var state = map.get(target);\n\t    if (state) {\n\t      return state;\n\t    }\n\t    map.set(target, this);\n\t\n\t    var keyMap = new _KeyMap2['default']();\n\t    this.cache = Object.keys(target).reduce(function (cache, key) {\n\t      var value = cache[key] = target[key];\n\t      if (State.isObject(value)) {\n\t        new State(value);\n\t      }\n\t      keyMap.set(value, key);\n\t      return cache;\n\t    }, {});\n\t\n\t    this.keyMap = keyMap;\n\t    this.target = target;\n\t    this.lastCheck = State.now();\n\t    this.lastChange = 0;\n\t  }\n\t\n\t  _createClass(State, [{\n\t    key: 'isChanged',\n\t    value: function isChanged() {\n\t      var _this = this;\n\t\n\t      var timestamp = State.now();\n\t\n\t      if (timestamp > this.lastCheck) {\n\t        (function () {\n\t          var changed = false;\n\t\n\t          _this.lastCheck = timestamp;\n\t          _this.changelog = {};\n\t\n\t          Object.keys(_this.cache).forEach(function (key) {\n\t            if (!_this.target.hasOwnProperty(key)) {\n\t              var value = _this.cache[key];\n\t              _this.changelog[key] = { type: 'delete', oldValue: value };\n\t              changed = true;\n\t            }\n\t          });\n\t\n\t          var keyMap = new _KeyMap2['default']();\n\t          var cacheNewKeys = {};\n\t          _this.cache = Object.keys(_this.target).reduce(function (cache, key) {\n\t            var value = _this.target[key];\n\t\n\t            if (!_this.cache.hasOwnProperty(key)) {\n\t              _this.changelog[key] = { type: 'set' };\n\t              changed = true;\n\t            } else if (!State.is(value, _this.cache[key])) {\n\t              _this.changelog[key] = _this.changelog[key] || { type: 'set' };\n\t              _this.changelog[key].oldValue = _this.cache[key];\n\t              changed = true;\n\t            }\n\t\n\t            if (State.isObject(value)) {\n\t              var nestedState = new State(value);\n\t              if (nestedState.isChanged()) {\n\t                changed = true;\n\t                if (!_this.changelog[key]) {\n\t                  _this.changelog[key] = { type: 'modify' };\n\t                  _this.changelog[key].changelog = nestedState.changelog;\n\t                }\n\t              }\n\t            }\n\t\n\t            if (_this.changelog[key]) {\n\t              var oldKey = _this.keyMap.shift(value, key);\n\t              if (oldKey && oldKey !== key && _this.target[oldKey] !== value) {\n\t                _this.changelog[key].oldKey = oldKey;\n\t                if (_this.changelog[oldKey]) {\n\t                  _this.changelog[oldKey].newKey = key;\n\t                } else {\n\t                  cacheNewKeys[oldKey] = key;\n\t                }\n\t              }\n\t\n\t              if (cacheNewKeys[key]) {\n\t                _this.changelog[key].newKey = cacheNewKeys[key];\n\t              }\n\t            }\n\t\n\t            cache[key] = value;\n\t            keyMap.set(value, key);\n\t            return cache;\n\t          }, {});\n\t\n\t          _this.keyMap = keyMap;\n\t\n\t          if (changed) {\n\t            _this.lastChange = _this.lastCheck;\n\t          } else {\n\t            _this.changelog = undefined;\n\t          }\n\t        })();\n\t      }\n\t\n\t      return this.lastChange === timestamp;\n\t    }\n\t  }]);\n\t\n\t  return State;\n\t})();\n\t\n\texports['default'] = State;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar KeyMap = (function () {\n\t  function KeyMap() {\n\t    _classCallCheck(this, KeyMap);\n\t\n\t    this.map = new Map();\n\t  }\n\t\n\t  _createClass(KeyMap, [{\n\t    key: \"set\",\n\t    value: function set(key, value) {\n\t      var list = this.map.get(key);\n\t      if (!list) {\n\t        list = new Set();\n\t        this.map.set(key, list);\n\t      }\n\t\n\t      if (value) {\n\t        list.add(value);\n\t      }\n\t\n\t      return list;\n\t    }\n\t  }, {\n\t    key: \"shift\",\n\t    value: function shift(key, value) {\n\t      var set = this.map.get(key);\n\t      if (set && set.size) {\n\t        if (set.has(value)) {\n\t          set[\"delete\"](value);\n\t          return value;\n\t        } else {\n\t          var _iteratorNormalCompletion = true;\n\t          var _didIteratorError = false;\n\t          var _iteratorError = undefined;\n\t\n\t          try {\n\t            for (var _iterator = set[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t              var result = _step.value;\n\t\n\t              set[\"delete\"](result);\n\t              return result;\n\t            }\n\t          } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t          } finally {\n\t            try {\n\t              if (!_iteratorNormalCompletion && _iterator[\"return\"]) {\n\t                _iterator[\"return\"]();\n\t              }\n\t            } finally {\n\t              if (_didIteratorError) {\n\t                throw _iteratorError;\n\t              }\n\t            }\n\t          }\n\t        }\n\t      }\n\t      return false;\n\t    }\n\t  }]);\n\t\n\t  return KeyMap;\n\t})();\n\t\n\texports[\"default\"] = KeyMap;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _State = __webpack_require__(1);\n\t\n\tvar _State2 = _interopRequireDefault(_State);\n\t\n\tvar _PropertyObserver = __webpack_require__(4);\n\t\n\tvar _PropertyObserver2 = _interopRequireDefault(_PropertyObserver);\n\t\n\tvar Observer = (function () {\n\t  _createClass(Observer, null, [{\n\t    key: 'requestAnimationFrame',\n\t    value: function requestAnimationFrame(cb) {\n\t      var _this = this;\n\t\n\t      if (!this._request) {\n\t        this._callbacks = new Set().add(cb);\n\t        this._request = window.requestAnimationFrame(function () {\n\t          _this._callbacks.forEach(function (cb) {\n\t            return cb();\n\t          });\n\t          _this._request = _this._callbacks = undefined;\n\t        });\n\t      } else {\n\t        this._callbacks.add(cb);\n\t      }\n\t\n\t      return cb;\n\t    }\n\t  }, {\n\t    key: 'cancelAnimationFrame',\n\t    value: function cancelAnimationFrame(cb) {\n\t      if (this._callbacks) {\n\t        this._callbacks['delete'](cb);\n\t      }\n\t    }\n\t  }]);\n\t\n\t  function Observer(host, keys, callback) {\n\t    var _this2 = this;\n\t\n\t    _classCallCheck(this, Observer);\n\t\n\t    if (!host || !keys || !callback) {\n\t      throw new TypeError('Invalid arguments');\n\t    }\n\t\n\t    this.callback = callback;\n\t    this.revert = [];\n\t\n\t    this.state = new _State2['default']([].concat(keys).reduce(function (list, key) {\n\t      var observer = new _PropertyObserver2['default'](host, key);\n\t      list[key] = host[key];\n\t\n\t      _this2.revert.push(observer.observe(function (value) {\n\t        if (!_State2['default'].is(list[key], value)) {\n\t          list[key] = value;\n\t          _this2.check();\n\t        } else if (_State2['default'].isObject(value)) {\n\t          _this2.check();\n\t        }\n\t      }));\n\t\n\t      return list;\n\t    }, {}));\n\t  }\n\t\n\t  _createClass(Observer, [{\n\t    key: 'check',\n\t    value: function check() {\n\t      var _this3 = this;\n\t\n\t      if (!this.checkFn) {\n\t        this.checkFn = Observer.requestAnimationFrame(function () {\n\t          if (_this3.state.isChanged()) {\n\t            _this3.callback(_this3.state.changelog);\n\t          }\n\t\n\t          _this3.checkFn = undefined;\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      if (this.checkFn) {\n\t        Observer.cancelAnimationFrame(this.checkFn);\n\t      }\n\t\n\t      this.revert.forEach(function (cb) {\n\t        return cb();\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return Observer;\n\t})();\n\t\n\texports['default'] = Observer;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\t\n\tvar _PropertyProxy = __webpack_require__(5);\n\t\n\tvar _PropertyProxy2 = _interopRequireDefault(_PropertyProxy);\n\t\n\tvar register = new WeakMap();\n\t\n\tvar PropertyObserver = (function () {\n\t  _createClass(PropertyObserver, null, [{\n\t    key: 'singleton',\n\t    value: function singleton(host, key, target) {\n\t      var instance = register.get(host);\n\t      if (instance) {\n\t        if (instance[key]) {\n\t          return instance[key];\n\t        } else {\n\t          instance[key] = target;\n\t        }\n\t      } else {\n\t        register.set(host, _defineProperty({}, key, target));\n\t      }\n\t\n\t      return target;\n\t    }\n\t  }]);\n\t\n\t  function PropertyObserver(host, key) {\n\t    var _this = this;\n\t\n\t    _classCallCheck(this, PropertyObserver);\n\t\n\t    var singleton = PropertyObserver.singleton(host, key, this);\n\t    if (singleton !== this) {\n\t      return singleton;\n\t    }\n\t\n\t    this.proxy = new _PropertyProxy2['default'](host, key, function (value) {\n\t      return _this.getters.forEach(function (cb) {\n\t        return cb(value);\n\t      });\n\t    }, function (newValue) {\n\t      return _this.setters.forEach(function (cb) {\n\t        return cb(newValue);\n\t      });\n\t    });\n\t\n\t    this.getters = new Set();\n\t    this.setters = new Set();\n\t  }\n\t\n\t  _createClass(PropertyObserver, [{\n\t    key: 'observe',\n\t    value: function observe(get, set) {\n\t      var _this2 = this;\n\t\n\t      if (!this.getters.size) {\n\t        this.proxy.on();\n\t      }\n\t\n\t      this.getters.add(get);\n\t      this.setters.add(set || get);\n\t\n\t      return function () {\n\t        _this2.unobserve(get, set);\n\t      };\n\t    }\n\t  }, {\n\t    key: 'unobserve',\n\t    value: function unobserve(get, set) {\n\t      this.getters['delete'](get);\n\t      this.setters['delete'](set || get);\n\t\n\t      if (!this.getters.size && !this.setters.size) {\n\t        this.proxy.off();\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return PropertyObserver;\n\t})();\n\t\n\texports['default'] = PropertyObserver;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar PropertyProxy = (function () {\n\t  function PropertyProxy(host, key, get, set) {\n\t    _classCallCheck(this, PropertyProxy);\n\t\n\t    this.host = host;\n\t    this.key = key;\n\t    this.getter = get;\n\t    this.setter = set || get;\n\t  }\n\t\n\t  _createClass(PropertyProxy, [{\n\t    key: \"getOwnDescriptor\",\n\t    value: function getOwnDescriptor() {\n\t      var desc = Object.getOwnPropertyDescriptor(this.host, this.key);\n\t\n\t      if (desc) {\n\t        if (!desc.configurable) {\n\t          throw new TypeError(\"Cannot create proxy for not configurable property '\" + this.key + \"'\");\n\t        }\n\t        if (!desc.get && !desc.set && !desc.writable) {\n\t          throw new TypeError(\"Cannot create proxy for readonly property '\" + this.key + \"'\");\n\t        }\n\t      }\n\t\n\t      return desc;\n\t    }\n\t  }, {\n\t    key: \"getProtoDescriptor\",\n\t    value: function getProtoDescriptor() {\n\t      var _this = this;\n\t\n\t      var desc = undefined,\n\t          host = Object.getPrototypeOf(this.host);\n\t\n\t      while (host) {\n\t        desc = Object.getOwnPropertyDescriptor(host, this.key);\n\t        if (desc) {\n\t          break;\n\t        } else {\n\t          host = Object.getPrototypeOf(host);\n\t        }\n\t      }\n\t\n\t      if (desc) {\n\t        if (!desc.get && !desc.set) {\n\t          desc.get = function () {\n\t            delete _this.host[_this.key];\n\t            var value = _this.host[_this.key];\n\t            _this.on();\n\t            return value;\n\t          };\n\t          desc.set = function (newVal) {\n\t            delete _this.host[_this.key];\n\t            _this.host[_this.key] = newVal;\n\t            _this.on();\n\t          };\n\t        }\n\t      }\n\t\n\t      return desc;\n\t    }\n\t  }, {\n\t    key: \"on\",\n\t    value: function on() {\n\t      var desc = this.getOwnDescriptor();\n\t\n\t      if (desc) {\n\t        this.ownProperty = true;\n\t      } else {\n\t        this.ownProperty = false;\n\t        desc = this.getProtoDescriptor();\n\t      }\n\t\n\t      if (!desc) {\n\t        this.ownProperty = true;\n\t        this.notDefined = true;\n\t        desc = {\n\t          enumerable: true,\n\t          writable: true,\n\t          configurable: true\n\t        };\n\t      }\n\t\n\t      this.desc = desc;\n\t      this.value = this.host[this.key];\n\t\n\t      Object.defineProperty(this.host, this.key, {\n\t        configurable: true,\n\t        enumerable: this.desc.enumerable,\n\t        get: this.get.bind(this),\n\t        set: this.set.bind(this)\n\t      });\n\t    }\n\t  }, {\n\t    key: \"off\",\n\t    value: function off() {\n\t      if (this.ownProperty) {\n\t        if (this.notDefined) {\n\t          delete this.host[this.key];\n\t        } else {\n\t          if (!this.desc.get && !this.desc.set) {\n\t            this.desc.value = this.value;\n\t          }\n\t          Object.defineProperty(this.host, this.key, this.desc);\n\t        }\n\t      } else {\n\t        delete this.host[this.key];\n\t      }\n\t    }\n\t  }, {\n\t    key: \"get\",\n\t    value: function get() {\n\t      if (this.desc.get) {\n\t        this.value = this.desc.get.call(this.host);\n\t      }\n\t      this.getter(this.value);\n\t      return this.value;\n\t    }\n\t  }, {\n\t    key: \"set\",\n\t    value: function set(newValue) {\n\t      this.notDefined = false;\n\t\n\t      if (this.desc.set) {\n\t        this.desc.set.call(this.host, newValue);\n\t      }\n\t\n\t      if (this.desc.writable || this.desc.get || this.desc.set) {\n\t        this.value = newValue;\n\t      }\n\t\n\t      this.setter(this.value);\n\t    }\n\t  }]);\n\t\n\t  return PropertyProxy;\n\t})();\n\t\n\texports[\"default\"] = PropertyProxy;\n\tmodule.exports = exports[\"default\"];\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** papillon.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap a1928f9122415496bf4e\n **/","export { default as State } from './src/State';\nexport { default as Observer } from './src/Observer';\n\n\n\n/** WEBPACK FOOTER **\n ** ./papillon.js\n **/","import KeyMap from './KeyMap';\n\nconst map = new WeakMap();\nlet timestamp = 0;\nlet request = false;\n\nclass State {\n\n  static now() {\n    if (!request) {\n      timestamp = timestamp + 1;\n      request = window.requestAnimationFrame(\n        ()=> request = undefined\n      );\n    }\n    return timestamp;\n  }\n\n  static isObject(target) {\n    return typeof(target) === 'object' && target !== null;\n  }\n\n  static is(v1, v2) {\n    if (v1 === 0 && v2 === 0) {\n      return 1 / v1 === 1 / v2;\n    }\n    if (v1 !== v1) {\n      return v2 !== v2;\n    }\n    return v1 === v2;\n  }\n\n  constructor(target) {\n    if (!State.isObject(target)) {\n      throw new TypeError('Invalid arguments');\n    }\n    const state = map.get(target);\n    if (state) { return state; }\n    map.set(target, this);\n\n    const keyMap = new KeyMap();\n    this.cache = Object.keys(target).reduce((cache, key)=> {\n      let value = cache[key] = target[key];\n      if (State.isObject(value)) {\n        new State(value);\n      }\n      keyMap.set(value, key);\n      return cache;\n    }, {});\n\n    this.keyMap = keyMap;\n    this.target = target;\n    this.lastCheck = State.now();\n    this.lastChange = 0;\n  }\n\n  isChanged() {\n    let timestamp = State.now();\n\n    if (timestamp > this.lastCheck) {\n      let changed = false;\n\n      this.lastCheck = timestamp;\n      this.changelog = {};\n\n      Object.keys(this.cache).forEach((key)=> {\n        if (!this.target.hasOwnProperty(key)) {\n          let value = this.cache[key];\n          this.changelog[key] = { type: 'delete', oldValue: value };\n          changed = true;\n        }\n      });\n\n      const keyMap = new KeyMap();\n      const cacheNewKeys = {};\n      this.cache = Object.keys(this.target).reduce((cache, key)=> {\n        const value = this.target[key];\n\n        if (!this.cache.hasOwnProperty(key)) {\n          this.changelog[key] = { type:'set' };\n          changed = true;\n        } else if (!State.is(value, this.cache[key])) {\n          this.changelog[key] = this.changelog[key] || { type: 'set'};\n          this.changelog[key].oldValue = this.cache[key];\n          changed = true;\n        }\n\n        if (State.isObject(value)) {\n          let nestedState = new State(value);\n          if (nestedState.isChanged()) {\n            changed = true;\n            if (!this.changelog[key]) {\n              this.changelog[key] = { type: 'modify' };\n              this.changelog[key].changelog = nestedState.changelog;\n            }\n          }\n        }\n\n        if (this.changelog[key]) {\n          const oldKey = this.keyMap.shift(value, key);\n          if (oldKey && oldKey !== key && this.target[oldKey] !== value) {\n            this.changelog[key].oldKey = oldKey;\n            if (this.changelog[oldKey]) {\n              this.changelog[oldKey].newKey = key;\n            } else {\n              cacheNewKeys[oldKey] = key;\n            }\n          }\n\n          if (cacheNewKeys[key]) {\n            this.changelog[key].newKey = cacheNewKeys[key];\n          }\n        }\n\n        cache[key] = value;\n        keyMap.set(value, key);\n        return cache;\n      }, {});\n\n      this.keyMap = keyMap;\n\n      if (changed) {\n        this.lastChange = this.lastCheck;\n      } else {\n        this.changelog = undefined;\n      }\n    }\n\n    return this.lastChange === timestamp;\n  }\n}\n\nexport default State;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/State.js\n **/","class KeyMap {\n    constructor() {\n      this.map = new Map();\n    }\n\n    set(key, value) {\n      let list = this.map.get(key);\n      if (!list) {\n        list = new Set();\n        this.map.set(key, list);\n      }\n\n      if (value) {\n        list.add(value);\n      }\n\n      return list;\n    }\n\n    shift(key, value) {\n      let set = this.map.get(key);\n      if (set && set.size) {\n        if (set.has(value)) {\n          set.delete(value);\n          return value;\n        } else {\n          for(let result of set) {\n            set.delete(result);\n            return result;\n          }\n        }\n      }\n      return false;\n    }\n}\n\nexport default KeyMap;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/KeyMap.js\n **/","import State from './State';\nimport PropertyObserver from './PropertyObserver';\n\nclass Observer {\n  static requestAnimationFrame(cb) {\n    if (!this._request) {\n      this._callbacks = new Set().add(cb);\n      this._request = window.requestAnimationFrame(()=> {\n        this._callbacks.forEach(cb => cb());\n        this._request = this._callbacks = undefined;\n      });\n    } else {\n      this._callbacks.add(cb);\n    }\n\n    return cb;\n  }\n\n  static cancelAnimationFrame(cb) {\n    if (this._callbacks) {\n      this._callbacks.delete(cb);\n    }\n  }\n\n  constructor(host, keys, callback) {\n    if (!host || !keys || !callback) {\n      throw new TypeError('Invalid arguments');\n    }\n\n    this.callback = callback;\n    this.revert = [];\n\n    this.state = new State(\n      [].concat(keys).reduce( (list, key) => {\n        let observer = new PropertyObserver(host, key);\n        list[key] = host[key];\n\n        this.revert.push(observer.observe((value)=> {\n          if (!State.is(list[key], value)) {\n            list[key] = value;\n            this.check();\n          } else if (State.isObject(value)) {\n            this.check();\n          }\n        }));\n\n        return list;\n      }, {})\n    );\n  }\n\n  check() {\n    if (!this.checkFn) {\n      this.checkFn = Observer.requestAnimationFrame(()=> {\n        if (this.state.isChanged()) {\n          this.callback(this.state.changelog);\n        }\n\n        this.checkFn = undefined;\n      });\n    }\n  }\n\n  destroy() {\n    if (this.checkFn) {\n      Observer.cancelAnimationFrame(this.checkFn);\n    }\n\n    this.revert.forEach(cb => cb());\n  }\n}\n\nexport default Observer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Observer.js\n **/","import PropertyProxy from './PropertyProxy';\n\nlet register = new WeakMap();\n\nclass PropertyObserver {\n  static singleton(host, key, target) {\n    let instance = register.get(host);\n    if (instance) {\n      if (instance[key]) {\n        return instance[key];\n      } else {\n        instance[key] = target;\n      }\n    } else {\n      register.set(host, { [key]: target });\n    }\n\n    return target;\n  }\n\n  constructor(host, key) {\n    let singleton = PropertyObserver.singleton(host, key, this);\n    if (singleton !== this) {\n      return singleton;\n    }\n\n    this.proxy = new PropertyProxy(host, key,\n      (value)=> this.getters.forEach(cb => cb(value)),\n      (newValue)=> this.setters.forEach(cb => cb(newValue))\n    );\n\n    this.getters = new Set();\n    this.setters = new Set();\n  }\n\n  observe(get, set) {\n    if (!this.getters.size) {\n      this.proxy.on();\n    }\n\n    this.getters.add(get);\n    this.setters.add(set || get);\n\n    return ()=> {\n      this.unobserve(get, set);\n    };\n  }\n\n  unobserve(get, set) {\n    this.getters.delete(get);\n    this.setters.delete(set || get);\n\n    if (!this.getters.size && !this.setters.size) {\n      this.proxy.off();\n    }\n  }\n}\n\nexport default PropertyObserver;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/PropertyObserver.js\n **/","class PropertyProxy {\n  constructor(host, key, get, set) {\n    this.host = host;\n    this.key = key;\n    this.getter = get;\n    this.setter = set || get;\n  }\n\n  getOwnDescriptor() {\n    let desc = Object.getOwnPropertyDescriptor(this.host, this.key);\n\n    if (desc) {\n      if (!desc.configurable) {\n        throw new TypeError(\n          `Cannot create proxy for not configurable property '${this.key}'`);\n      }\n      if (!desc.get && !desc.set && !desc.writable) {\n        throw new TypeError(\n          `Cannot create proxy for readonly property '${this.key}'`);\n      }\n    }\n\n    return desc;\n  }\n\n  getProtoDescriptor() {\n    let desc, host = Object.getPrototypeOf(this.host);\n\n    while(host) {\n      desc = Object.getOwnPropertyDescriptor(host, this.key);\n      if (desc) {\n        break;\n      } else {\n        host = Object.getPrototypeOf(host);\n      }\n    }\n\n    if (desc) {\n      if (!desc.get && !desc.set) {\n        desc.get = ()=> {\n          delete this.host[this.key];\n          let value = this.host[this.key];\n          this.on();\n          return value;\n        };\n        desc.set = (newVal)=> {\n          delete this.host[this.key];\n          this.host[this.key] = newVal;\n          this.on();\n        };\n      }\n    }\n\n    return desc;\n  }\n\n  on() {\n    let desc = this.getOwnDescriptor();\n\n    if (desc) {\n      this.ownProperty = true;\n    } else {\n      this.ownProperty = false;\n      desc = this.getProtoDescriptor();\n    }\n\n    if (!desc) {\n      this.ownProperty = true;\n      this.notDefined = true;\n      desc = {\n        enumerable: true,\n        writable: true,\n        configurable: true\n      };\n    }\n\n    this.desc = desc;\n    this.value = this.host[this.key];\n\n    Object.defineProperty(this.host, this.key, {\n      configurable: true,\n      enumerable: this.desc.enumerable,\n      get: this.get.bind(this),\n      set: this.set.bind(this)\n    });\n  }\n\n  off() {\n    if (this.ownProperty) {\n      if (this.notDefined) {\n        delete this.host[this.key];\n      } else {\n        if (!this.desc.get && !this.desc.set) {\n          this.desc.value = this.value;\n        }\n        Object.defineProperty(this.host, this.key, this.desc);\n      }\n    } else {\n      delete this.host[this.key];\n    }\n  }\n\n  get() {\n    if (this.desc.get) {\n      this.value = this.desc.get.call(this.host);\n    }\n    this.getter(this.value);\n    return this.value;\n  }\n\n  set(newValue) {\n    this.notDefined = false;\n\n    if (this.desc.set) {\n      this.desc.set.call(this.host, newValue);\n    }\n\n    if (this.desc.writable || this.desc.get || this.desc.set) {\n      this.value = newValue;\n    }\n\n    this.setter(this.value);\n  }\n}\n\nexport default PropertyProxy;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/PropertyProxy.js\n **/"],"sourceRoot":""}